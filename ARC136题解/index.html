<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>ARC136题解 | Wilson&#39;s blog</title>
  <link rel="stylesheet" href="/css/fonts/Chinese-normal-normal.min.css">
  <link rel="stylesheet" href="/css/fonts/ChineseMono-normal-normal.min.css">
  <link rel="stylesheet" href="/css/fonts/Chinese-italic-normal.min.css">
  <link rel="stylesheet" href="/css/fonts/Chinese-normal-bold.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="description" content="这场 ARC 比较考验观察能力，就是找到切入点的能力。我会尽量在题解里给出一个观察的过程，至于证明，比猜到结论简单。这场暴露出来我的容易进死胡同的问题，也可能是人类本质。就是一种思路做不出来的时候跳不出来，思维僵化了。以后训练中得注意对想不出来的题尝试“跳出思维定势”。也可能只是 trick 掌握得">
  
  
    <link rel="alternate" href=".././atom.xml" title="Wilson's blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href=".././favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <div id="nav-outer">
  <nav id="main-nav" class="outer">
    <a id="main-nav-toggle" class="nav-icon"></a>
    
      <a class="main-nav-link" href=".././index.html">Home</a>
    
      <a class="main-nav-link" href=".././archives/">Archives</a>
    
      <a class="main-nav-link" href=".././about/">About</a>
    
    <div class="main-nav-space-between"></div>
    
      <a id="nav-rss-link" class="nav-icon" href=".././atom.xml" title="RSS 订阅"></a>
    
  </nav>
</div>
<div id="header-title">
  <h1 id="logo-wrap">
    <a href=".././index.html" id="logo">Wilson&#39;s blog</a>
  </h1>
  
</div>

      <div id="content" class="outer">
        <section id="main"><article id="post-ARC136题解" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="./" class="article-date">
  <time class="dt-published" datetime="2022-03-01T13:17:35.000Z" itemprop="datePublished">2022-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      ARC136题解
    </h1>
  

      </header>
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>这场 ARC 比较考验观察能力<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>就是找到切入点的能力<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>我会尽量在题解里给出一个观察的过程<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>至于证明<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>比猜到结论简单<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>这场暴露出来我的容易进死胡同的问题<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>也可能是人类本质<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>就是一种思路做不出来的时候跳不出来<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>思维僵化了<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>以后训练中得注意对想不出来的题尝试<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>跳出思维定势<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>也可能只是 trick 掌握得不够<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>导致跳出来也不知道想啥<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>可以先多积累些思路<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>毕竟<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>思而不学则殆<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<h2 id="c-- circular addition">C - Circular Addition</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc136/tasks/arc136_c">题面</a></p>
<p>收获的思路<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span></p>
<ol>
<li>在差分数组上看区间加减</li>
<li>问最小操作次数时<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>找几个下界<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>尝试证明其最大值可以取到<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>证明时可以尝试把创造过程逆转为消除过程<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>因为消除时的信息更多<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>而创造是在<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>创造<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>信息<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
</ol>
<p>我看到了第一个切入点<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>用差分数组处理区间加减问题<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>如果您对这个题毫无头绪<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>可以先对着这句话看自己能想到哪一步<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>将目标数组看作环并作长为 <span class="markdown-them-math-inline">$n$</span> 的差分数组<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>发现这个差分数组和一定为 0<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>而且每次操作一定是使得一个数 +1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>一个数 -1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>显然我们可以通过每次选择一正一负的一对位置操作来得到目标差分数组<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>操作次数为<em>差分数组中正值之和</em><span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<p>然后我发现过不了最后一个样例<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>仔细一看发现其实也没能给出前两个样例的具体操作步骤<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>不太对劲<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>具体来说<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>就是可以交换差分数组上的操作顺序来获得额外的<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>全体 +1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span> buff<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这个信息在差分数组里被丢掉了<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>从这时开始<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>我就开始想着怎么最大化这个 buff<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>以及是不是最大 buff 和零 buff 之间的所有值都能取到<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>陷入了苦战<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<p>按照题解来讲的话<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>我们已经观察到了一个操作次数下界<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>还有另一个显然的下界<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>就是数组中的最大值<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>我们猜想<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span>他们中的最大值是可以被取到的<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>然后反过来想将目标数组变为 0 的过程<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>我们发现这个思路在近达上一场比赛 ARC135D 中就出现过<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>需要学习一个<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<p>实际应用中<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这种猜想很可能会错<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>尤其是难题<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>所以姑且提出一个做题步骤<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span></p>
<ol>
<li>观察总结此前得到的事实<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>提出猜想</li>
<li>代入样例<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>若有误返回1</li>
<li>尝试证明<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>若证伪返回1</li>
<li>如果证明或不会证而自信<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>开码</li>
<li>如果没证出来且不太自信<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>多造点样例<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>再次手玩或对拍<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>若有误返回1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>否则开码</li>
</ol>
<p>按照步骤<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>我们应当代入样例<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>发现没问题<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>开始尝试证明<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>如果我们在每一时刻都能降低<strong>这一时刻的</strong><span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>差分数组下界<span class="markdown-them-math-inline">$L_1$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>和<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>最大值下界<span class="markdown-them-math-inline">$L_2$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>中的最大值<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>我们就构造性地证明了猜想的正确性<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>为了降低最大者<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>我们需要对<span class="markdown-them-math-inline">$L_1$</span>和<span class="markdown-them-math-inline">$L_2$</span>的大小做出假设来进行进一步推理<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<ol>
<li><span class="markdown-them-math-inline">$L_1&lt;L_2$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span>此时数组中不可能有 0<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>否则为了从 0 增加到 <span class="markdown-them-math-inline">$L_2$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>差分数组中正值部分至少是 <span class="markdown-them-math-inline">$L_2$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这与 <span class="markdown-them-math-inline">$L_1&lt;L_2$</span> 矛盾<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>于是全体 -1 即可<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这样能使 <span class="markdown-them-math-inline">$L_2$</span> 减小 1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
<li><span class="markdown-them-math-inline">$L_1&gt;L_2$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span>如果数组中有 0<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>我们只要挑选一段包含最大值的极大非零区间来全体 -1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这样能使 <span class="markdown-them-math-inline">$L_1$</span> 减小 1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>如果数组中没有 0<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>数组中一定有若干<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>山谷<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>所以一定可以找一段极大的<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>连续最大值区间<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char><h-char class="bd bd-end"><h-inner>（</h-inner></h-char></span>要求其左右不再是最大值<span class="bd-box"><h-char class="bd bd-beg"><h-inner>）</h-inner></h-char></span>来减 1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这能使 <span class="markdown-them-math-inline">$L_1$</span> 减小 1<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
<li><span class="markdown-them-math-inline">$L_1=L_2$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span>如果数组中有 0<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>一定是单调增加到 <span class="markdown-them-math-inline">$L_2$</span> 再单调减小到 0<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>将非零部分 -1 即可同时减小 <span class="markdown-them-math-inline">$L_1$</span> 和 <span class="markdown-them-math-inline">$L_2$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>如果数组中没有0<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>数组中一定有若干<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>山谷<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>如果*极大的<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>连续最大值区间<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>*唯一<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>那么将其减 1 即可<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>否则<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>一定可以找到一个区间覆盖所有的最大值<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>例如除去最小值后获得的区间<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>将这个区间全体减 1 即可<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
</ol>
<p>把这个过程反过来想会变得更难想<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>尤其是 <span class="markdown-them-math-inline">$L_1=L_2$</span> 时的操作<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>所以这个<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>减小双下限最大值<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>的 trick 应该被加入知识库<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<h2 id="d-- without carry">D - Without Carry</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc136/tasks/arc136_d">题面</a></p>
<p>收获<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span>SOSdp</p>
<p>推荐博文<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span><a target="_blank" rel="noopener" href="https://codeforces.com/blog/entry/45223">SOSdp</a><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span><a target="_blank" rel="noopener" href="https://codeforces.com/blog/entry/72488">zeta transform</a> 前者为后者前置知识<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>本题只需要学习前者<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>但是来都来了<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>为什么不都学一下呢<span class="bd-box"><h-char class="bd bd-beg"><h-inner>？</h-inner></h-char></span></p>
<p>读完博文直接就会做了<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>不会就看官方题解<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>不必多说<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<h2 id="e-- non-coprime dag">E - Non-coprime DAG</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc136/tasks/arc136_e">题面</a></p>
<p>收获<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span><s>我观察能力低下<span class="bd-box"><h-char class="bd bd-beg"><h-inner>？</h-inner></h-char></span></s></p>
<ol>
<li>不够耐心<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>一条思路还没想透彻就放弃</li>
<li>可以把结论写出来<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>更容易发现规律<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>形式的不同会影响思考方式</li>
</ol>
<p>在看题解之前<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>您至少应该发现<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>不可达<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>和<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>互质<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>并不等价<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>例如9可以经12和14到达35<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>并且经过了一定的思考<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<p>对 <span class="markdown-them-math-inline">$i&lt;j$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>考察 <span class="markdown-them-math-inline">$i$</span> 是否可达 <span class="markdown-them-math-inline">$j$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>后文同余符号皆模 2 <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span><span class="markdown-them-math-inline">$f(i)$</span> 为 <span class="markdown-them-math-inline">$i$</span> 的最小质因子<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<ol>
<li><span class="markdown-them-math-inline">$i\equiv 0,\;j\equiv 0$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>此时一定可达<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
<li><span class="markdown-them-math-inline">$i\equiv 0,\;j\equiv 1$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>此时来到了第一个重要观察<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span>可以尝试经过 <span class="markdown-them-math-inline">$j - f(j)$</span> 这一偶数到达 <span class="markdown-them-math-inline">$j$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>所以不超过 <span class="markdown-them-math-inline">$j-f(j)$</span> 的偶数都 ok <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>即要求<span class="markdown-them-math-inline">$i\leq j-f(j)$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>而比它大的偶数<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>和 <span class="markdown-them-math-inline">$j$</span> 的差距已经小于其最小质因子了<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>没有机会走到 <span class="markdown-them-math-inline">$j$</span> 了<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
<li><span class="markdown-them-math-inline">$i\equiv 1,\;j\equiv 0$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>类似于 2 <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>要求<span class="markdown-them-math-inline">$i+f(i)\leq j$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
<li><span class="markdown-them-math-inline">$i\equiv 1,\; j\equiv 1$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>此时来到了第二个重要观察<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>也是我卡住的地方<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>由于我没有将上面的观察列出来<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>我并没有注意经过偶数到达奇数这条路<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>或者隐约觉得这效率低下<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>其实这个类比还是比较明显的<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>大脑好用时起码可以猜一个结论出来<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>先写结论<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span><span class="markdown-them-math-inline">$i+f(i)\leq j-f(j)$</span> 即可<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>首先<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>两者都是奇数<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这就决定了只加一个<span class="bd-box"><h-char class="bd bd-end"><h-inner>（</h-inner></h-char></span>一定为奇的<span class="bd-box"><h-char class="bd bd-beg"><h-inner>）</h-inner></h-char></span>质因数并不能使 <span class="markdown-them-math-inline">$i$</span> 到达 <span class="markdown-them-math-inline">$j$</span>  <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>至少要加 2 个<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>如果想由偶数搭桥<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>显然<code>i -&gt; i+f(i) -&gt; j-f(j) -&gt; j</code>的路径就是最优的<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>如果不这样做<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>要么 <span class="markdown-them-math-inline">$i,j$</span> 有公因子<span class="bd-box"><h-char class="bd bd-end"><h-inner>（</h-inner></h-char></span>此时 <span class="markdown-them-math-inline">$i+f(i)\leq j-f(j)$</span> 必成立<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>或者仍然可以理解为从偶数搭桥<span class="bd-box"><h-char class="bd bd-beg"><h-inner>）</h-inner></h-char><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>要么还是需要转到 <span class="markdown-them-math-inline">$j-fac(j)$</span> 再转到 <span class="markdown-them-math-inline">$j$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>其中 <span class="markdown-them-math-inline">$fac(j)$</span> 是 <span class="markdown-them-math-inline">$j$</span> 的某个因子<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>而这一个转变最少也要加 <span class="markdown-them-math-inline">$f(i)$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>转变后最少也要再加 <span class="markdown-them-math-inline">$f(j)$</span> 到达 <span class="markdown-them-math-inline">$j$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>本质还是从偶数搭桥<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></li>
</ol>
<p>现在我们获得了<span class="bd-box"><h-char class="bd bd-end"><h-inner>“</h-inner></h-char></span>可达<span class="bd-box"><h-char class="bd bd-beg"><h-inner>”</h-inner></h-char></span>的数学表达<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>我又卡在这里了<span class="bd-box"><h-char class="bd bd-end"><h-inner>（</h-inner></h-char></span>我去想 DAG 了并且没跳出来<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>悲<span class="bd-box"><h-char class="bd bd-beg"><h-inner>）</h-inner></h-char><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>注意到不等号左右的内容都很相似<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>并且右侧可以加1<span class="bd-box"><h-char class="bd bd-end"><h-inner>（</h-inner></h-char></span>因为模2的限制<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>两式仍然等价<span class="bd-box"><h-char class="bd bd-beg"><h-inner>）</h-inner></h-char><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>尝试总结为一个式子<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>可以将不等式变形为<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span></p>
<ol>
<li><span class="markdown-them-math-inline">$i+1\leq j$</span></li>
<li><span class="markdown-them-math-inline">$i+1\leq j-f(j)+1$</span></li>
<li><span class="markdown-them-math-inline">$i+f(i)\leq j$</span></li>
<li><span class="markdown-them-math-inline">$i+f(i)\leq j-f(j)+1$</span></li>
</ol>
<p>可以总结为<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span></p>
<p><span class="markdown-them-math-inline">$i$</span> 可达 <span class="markdown-them-math-inline">$j$</span> <span class="markdown-them-math-inline">$\Leftrightarrow$</span> <span class="markdown-them-math-inline">$up(i)\leq low(j)$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>其中 <span class="markdown-them-math-inline">$up(i)=(i\equiv0)?i+1:i+f(i)$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char><h-char class="bd bd-end"><h-inner>（</h-inner></h-char></span>注意这个 <span class="markdown-them-math-inline">$+1$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>这是因为 <span class="markdown-them-math-inline">$i&lt;j$</span> 不带等号<span class="bd-box"><h-char class="bd bd-beg"><h-inner>）</h-inner></h-char></span><span class="markdown-them-math-inline">$low(j)=(j\equiv0)?j:j-f(j)+1$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>
<p>再次总结这个表达<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>对任意的 <span class="markdown-them-math-inline">$i, j$</span><span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>当且仅当 <span class="markdown-them-math-inline">$up(i)\leq low(j)$</span> 或 <span class="markdown-them-math-inline">$up(j)\leq low(i)$</span> 时他们之间可达<span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>用区间语言表达就更干净<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span><span class="markdown-them-math-inline">$[low(i), up(i))$</span> 与 <span class="markdown-them-math-inline">$[low(j),up(j))$</span> 没有交点时可达<span class="bd-box"><h-char class="bd bd-end"><h-inner>（</h-inner></h-char></span>注意区间开闭<span class="bd-box"><h-char class="bd bd-beg"><h-inner>）</h-inner></h-char><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>于是题目变成<span class="bd-box"><h-char class="bd bd-beg"><h-inner>：</h-inner></h-char></span>寻找有公共交点的区间族 <span class="markdown-them-math-inline">$\{[low(i), up(i))\mid i\in\mathbb{N}\}$</span> <span class="bd-box"><h-char class="bd bd-beg"><h-inner>，</h-inner></h-char></span>使得 <span class="markdown-them-math-inline">$\sum_{i}A_i$</span>最大<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span>随便做<span class="bd-box"><h-char class="bd bd-beg"><h-inner>。</h-inner></h-char></span></p>

      
    </div>
    <footer class="article-footer">
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href=".././tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href=".././Trie%E6%A0%91%E7%BB%B4%E6%8A%A4%E9%9B%86%E5%90%88%E7%9B%B8%E4%BA%A4%E6%80%A7/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Trie树维护集合相交性
        
      </div>
    </a>
  
  
    <a href=".././ARC135%E9%A2%98%E8%A7%A3/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          ARC135题解
        
      </div>
    </a>
  
</nav>

  
</article>


</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
        &copy; 2022 Wilson Xia<br>
Powered by <a href="https://hexo.io/" target="_blank">Hexo</a><br>
      
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href=".././index.html" class="mobile-nav-link">Home</a>
  
    <a href=".././archives/" class="mobile-nav-link">Archives</a>
  
    <a href=".././about/" class="mobile-nav-link">About</a>
  
</nav>
    

<script src=".././js/clipboard.min.js"></script>
<script src=".././js/jquery-1.4.3.min.js"></script>

<script src=".././fancybox/jquery.fancybox-1.3.4.pack.js"></script>


<script src=".././js/script.js"></script>








  <link rel="stylesheet" href="/fancybox/jquery.fancybox-1.3.4.css">


  <link rel="stylesheet" href="/katex/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">

  <!-- The loading of KaTeX is deferred to speed up page rendering -->
  <script defer src="/katex/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>

  <!-- To automatically render math in text elements, include the auto-render extension: -->
  <script defer src="/katex/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
      onload="renderMathInElement(document.body);"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ],
        throwOnError : false
      });
    });
  </script>

  </div>
</body>
</html>